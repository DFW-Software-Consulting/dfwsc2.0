# DFWSC Frontend

React + Vite marketing site and onboarding UI.

## Development

```bash
npm install
npm run dev
```

By default the app expects the API at `http://localhost:4242/api/v1` when running locally.

Set `VITE_API_URL` in `front/.env` if you want a different API base URL.

## Testing

```bash
npm test
```

Frontend tests run with Vitest. Core flow coverage lives in `front/src/__tests__/coreFlows.test.jsx`.

## Architecture Overview

- **Routing**: React Router handles `/`, `/pricing`, `/team`, and `/onboard`.
- **Pages**: `src/pages/` contains the marketing pages and onboarding/admin flows.
- **API client**: requests are made to `VITE_API_URL` (default `http://localhost:4242/api/v1`).
- **Auth storage**: admin JWT is stored in `sessionStorage` under `adminToken`.

## Admin Dashboard Flow

The admin dashboard lives on the `/onboard` page alongside the client
token onboarding form.

1. Open `http://localhost:5173/onboard` (or `http://localhost:8080/onboard` in Docker dev).
2. Log in with `ADMIN_USERNAME` and `ADMIN_PASSWORD` via `POST /api/v1/auth/login`.
3. The UI stores the JWT in `sessionStorage` as `adminToken` and uses it for:
   - `GET /api/v1/clients`
   - `POST /api/v1/accounts`
   - `PATCH /api/v1/clients/:id`
4. Log out to clear the stored token.

### Token Expiry & Refresh
- Tokens expire based on `JWT_EXPIRY` (default `1h`).
- The UI does not auto-refresh tokens; expired tokens require logging in again.
- If the API returns `401`, prompt the admin to re-authenticate.

## Docker (served by nginx)

The production build is generated by `front/Dockerfile` and served by nginx.
Requests to `/api/*` are proxied to the `api` service defined in the root
`docker-compose.yml`.

## Docker (dev)

When using `docker-compose.dev.yml`, the Vite dev server runs on
`http://localhost:8080` and the onboarding UI is at `/onboard`.

## Build & Deploy

```bash
npm run build
```

- Vite emits static assets which are served by nginx in the Docker image.
- `front/nginx.conf` proxies `/api` to the backend container.
- For production, ensure `VITE_API_URL=/api/v1` so nginx handles routing.
