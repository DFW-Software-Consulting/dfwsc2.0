---
title: "React Hook Dependencies Fix – Plan"
phase: Plan
date: "2026-01-17_19-31-51"
owner: "agent"
parent_research: "memory-bank/tickets/2026-01-17/04-react-hook-deps.md"
git_commit_at_plan: "e79541c"
tags: [plan, react-hooks, frontend, lint]
---

## Goal

**Add missing `onSessionExpired` dependency to `updateClientStatus` callback in ClientList.jsx to satisfy React hook exhaustive-deps lint rule and prevent potential stale closure bugs.**

Non-goals:
- Do not refactor other hooks
- Do not add tests beyond verification
- Do not modify AdminDashboard.jsx (no actual issue found there)

## Scope & Assumptions

### In Scope
- Fix missing dependency in `front/src/components/admin/ClientList.jsx` line 78

### Out of Scope
- AdminDashboard.jsx fetchClients hook (research shows `showToast` is stable useCallback - no lint violation)
- Any other hook dependency issues not explicitly in ticket

### Assumptions
- `onSessionExpired` prop is a stable reference (confirmed: it's `handleLogout` wrapped in useCallback with `[]` deps)
- Adding it to dependency array will NOT cause infinite re-renders (confirmed safe)
- ESLint react-hooks/exhaustive-deps rule is active via `recommended-latest` preset

### Drift Note
**IMPORTANT:** Ticket references wrong file paths:
- Ticket says `front/src/pages/AdminDashboard.jsx:96` → Actual: `front/src/components/admin/AdminDashboard.jsx` (no issue found)
- Ticket says `front/src/pages/ClientList.jsx:425` → Actual: `front/src/components/admin/ClientList.jsx:78`

## Deliverables (DoD)

1. `ClientList.jsx` line 78 dependency array updated from `[onStatusChange, showToast]` to `[onStatusChange, showToast, onSessionExpired]`
2. No ESLint warnings for react-hooks/exhaustive-deps in affected files
3. UI behavior unchanged (manual verification in browser)

## Readiness (DoR)

- [x] Docker environment running (`docker-compose up -d`)
- [x] Frontend accessible at localhost:8080
- [x] Files identified and readable
- [x] ESLint configuration verified active

## Milestones

- **M1**: Single file edit to add missing dependency (1 line change)
- **M2**: Lint verification passes
- **M3**: Manual UI verification (client status toggle still works)

## Work Breakdown (Tasks)

| Task ID | Summary | Owner | Dependencies | Milestone |
|---------|---------|-------|--------------|-----------|
| T1 | Edit ClientList.jsx line 78 to add `onSessionExpired` to dependency array | agent | none | M1 |
| T2 | Run ESLint on frontend to verify no warnings | agent | T1 | M2 |
| T3 | Verify client status toggle works in browser (no regression) | user | T2 | M3 |

### T1: Edit ClientList.jsx dependency array

**Change:**
```diff
- }, [onStatusChange, showToast]);
+ }, [onStatusChange, showToast, onSessionExpired]);
```

**File:** `front/src/components/admin/ClientList.jsx`
**Line:** 78

**Acceptance Tests:**
- [ ] Line 78 contains `[onStatusChange, showToast, onSessionExpired]`

### T2: Lint verification

**Command:** `cd front && npm run lint`

**Acceptance Tests:**
- [ ] No react-hooks/exhaustive-deps warnings
- [ ] Exit code 0

### T3: Manual UI verification

**Steps:**
1. Navigate to admin dashboard
2. Toggle a client's status (active/inactive)
3. Verify toast appears and status updates

**Acceptance Tests:**
- [ ] Status toggle works without error
- [ ] No console warnings about hooks

## Risks & Mitigations

| Risk | Impact | Likelihood | Mitigation | Trigger |
|------|--------|------------|------------|---------|
| Adding dep causes re-renders | Medium | Very Low | onSessionExpired is stable useCallback with [] | Test toggle functionality |
| Lint has other unrelated warnings | Low | Medium | Focus only on exhaustive-deps rule | Check lint output |

## Test Strategy

- **ONE test approach:** Run existing lint check (`npm run lint` in front directory)
- No new test files needed - this is a lint compliance fix verified by existing tooling

## References

- Ticket: `memory-bank/tickets/2026-01-17/04-react-hook-deps.md`
- File to modify: `front/src/components/admin/ClientList.jsx:78`
- ESLint config: `front/eslint.config.js` (uses `reactHooks.configs['recommended-latest']`)

---

## Alternative Approach (NOT RECOMMENDED)

Could suppress the lint rule with `// eslint-disable-next-line react-hooks/exhaustive-deps` comment. **Not recommended** because:
- Hides potential bugs
- Goes against ticket intent
- Proper fix is trivial (1 line)

---

## Final Gate

| Item | Value |
|------|-------|
| Plan path | `memory-bank/plan/2026-01-17_19-31-51_react-hook-deps.md` |
| Milestones | 3 |
| Tasks | 3 |
| Files to modify | 1 |
| Lines to change | 1 |

**Next command:** `/ce-ex memory-bank/plan/2026-01-17_19-31-51_react-hook-deps.md`
